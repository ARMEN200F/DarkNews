<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–ú–æ–π —Å–∞–π—Ç</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000000; /* –ß—ë—Ä–Ω—ã–π —Ñ–æ–Ω */
            color: #FF0000; /* –ê–ª—ã–π (–∫—Ä–∞—Å–Ω—ã–π) —Ç–µ–∫—Å—Ç */
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .content {
            padding: 20px;
            background-color: #121212; /* –¢—ë–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è –±–ª–æ–∫–æ–≤ */
            margin-bottom: 20px;
        }
        .button-container {
            text-align: center;
            margin-top: 20px;
        }
        .button-container button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #FF0000; /* –ö—Ä–∞—Å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ */
            color: white;
            border: none;
            margin: 5px;
        }
        .article {
            background-color: #1a1a1a; /* –ï—â—ë –±–æ–ª–µ–µ —Ç—ë–º–Ω—ã–π —Ñ–æ–Ω –¥–ª—è —Å—Ç–∞—Ç–µ–π */
            padding: 10px;
            margin-bottom: 20px;
            border-left: 5px solid #FF0000; /* –ê–ª—ã–π –±–æ—Ä–¥–µ—Ä –¥–ª—è —Å—Ç–∞—Ç–µ–π */
        }
        .comment {
            background-color: #333333; /* –ï—â—ë —Ç—ë–º–Ω–µ–µ —Ñ–æ–Ω –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ */
            padding: 10px;
            margin-bottom: 10px;
        }
        textarea, input[type="text"], input[type="password"], input[type="email"] {
            background-color: #1a1a1a;
            color: white;
            border: 1px solid #555;
            width: 100%;
            padding: 8px;
            margin-top: 10px;
            resize: vertical;
        }
        img {
            display: block;
            margin-top: 10px;
            max-width: 100%;
            height: auto;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="content" id="loginSection">
        <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —Å–∞–π—Ç!</h1>
        <div class="button-container">
            <button onclick="showUserLogin()">–í–æ–π—Ç–∏ –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</button>
            <button onclick="showAuthorLogin()">–í–æ–π—Ç–∏ –∫–∞–∫ –∞–≤—Ç–æ—Ä</button>
        </div>
    </div>

    <div id="userLogin" class="content" style="display:none;">
        <h2>–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Gmail</h2>
        <input type="email" id="userEmail" placeholder="–í–≤–µ–¥–∏—Ç–µ Gmail" autocomplete="off" />
        <input type="password" id="userPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" autocomplete="off" />
        <button onclick="verifyUser()">–í–æ–π—Ç–∏ / –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
    </div>

    <div id="articles" class="content" style="display:none;">
        <h2>–°—Ç–∞—Ç—å–∏</h2>
        <div id="articleList"></div>
    </div>

    <div id="authorLogin" class="content" style="display:none;">
        <h2>–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥ –¥–ª—è –≤—Ö–æ–¥–∞ –∫–∞–∫ –∞–≤—Ç–æ—Ä</h2>
        <input type="text" id="promoCode" placeholder="–ü—Ä–æ–º–æ–∫–æ–¥" autocomplete="off" />
        <button onclick="verifyPromoCode()">–í–æ–π—Ç–∏ –∫–∞–∫ –∞–≤—Ç–æ—Ä</button>
    </div>

    <div id="authorSection" class="content" style="display:none;">
        <h2>–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é —Å—Ç–∞—Ç—å—é</h2>
        <textarea id="articleInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à—É —Å—Ç–∞—Ç—å—é..." rows="4"></textarea>
        
        <h3>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –≤–∞—à–µ–π —Å—Ç–∞—Ç—å–∏</h3>
        <input type="file" id="imageInput" accept="image/*" />

        <button onclick="submitArticle()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é</button>
    </div>
</div>

<script>
    // ----------------------- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è -----------------------
    const validPromoCode = "087212";

    let users = JSON.parse(localStorage.getItem("users")) || []; // –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ {email, password}

    function showUserLogin() {
        document.getElementById("userLogin").style.display = "block";
        document.getElementById("articles").style.display = "none";
        document.getElementById("authorLogin").style.display = "none";
        document.getElementById("authorSection").style.display = "none";
        document.getElementById("loginSection").style.display = "none";
    }

    function verifyUser() {
        const email = document.getElementById("userEmail").value.trim();
        const password = document.getElementById("userPassword").value.trim();

        if (!email || !password) {
            alert("–í–≤–µ–¥–∏—Ç–µ Gmail –∏ –ø–∞—Ä–æ–ª—å");
            return;
        }

        const existingUser = users.find(u => u.email === email);
        if (!existingUser) {
            // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            users.push({email: email, password: password});
            localStorage.setItem("users", JSON.stringify(users));
            alert("–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –í—ã –≤–æ—à–ª–∏.");
            showArticles();
        } else {
            if (existingUser.password === password) {
                alert("–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!");
                showArticles();
            } else {
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è —ç—Ç–æ–≥–æ Gmail");
            }
        }
    }

    function showAuthorLogin() {
        document.getElementById("authorLogin").style.display = "block";
        document.getElementById("articles").style.display = "none";
        document.getElementById("authorSection").style.display = "none";
        document.getElementById("userLogin").style.display = "none";
        document.getElementById("loginSection").style.display = "none";
    }

    function verifyPromoCode() {
        const promoCode = document.getElementById("promoCode").value.trim();
        if (promoCode === validPromoCode) {
            document.getElementById("authorSection").style.display = "block";
            document.getElementById("authorLogin").style.display = "none";
        } else {
            alert("–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ–º–æ–∫–æ–¥");
        }
    }

    // ----------------------- –°—Ç–∞—Ç—å–∏ -----------------------
    let articles = JSON.parse(localStorage.getItem("articles")) || [];
    let comments = JSON.parse(localStorage.getItem("comments")) || [];
    let likes = JSON.parse(localStorage.getItem("likes")) || [];

    function submitArticle() {
        const articleText = document.getElementById("articleInput").value.trim();
        const imageFile = document.getElementById("imageInput").files[0];

        if (!articleText && !imageFile) {
            alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ–±–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.");
            return;
        }

        if (imageFile) {
            const reader = new FileReader();
            reader.onloadend = function () {
                saveArticle(articleText, reader.result);
            };
            reader.readAsDataURL(imageFile);
        } else {
            saveArticle(articleText, "");
        }
    }

    function saveArticle(text, image) {
        const newArticle = { text: text, image: image };
        articles.push(newArticle);
        comments.push([]);
        likes.push(0);
        saveToStorage();
        displayArticles();

        document.getElementById("articleInput").value = "";
        document.getElementById("imageInput").value = "";
    }

    function saveToStorage() {
        localStorage.setItem("articles", JSON.stringify(articles));
        localStorage.setItem("comments", JSON.stringify(comments));
        localStorage.setItem("likes", JSON.stringify(likes));
    }

    function showArticles() {
        document.getElementById("articles").style.display = "block";
        document.getElementById("authorLogin").style.display = "none";
        document.getElementById("authorSection").style.display = "none";
        document.getElementById("userLogin").style.display = "none";
        document.getElementById("loginSection").style.display = "none";
        displayArticles();
    }

    function displayArticles() {
        const articleList = document.getElementById("articleList");
        articleList.innerHTML = "";

        articles.forEach((article, index) => {
            const articleDiv = document.createElement("div");
            articleDiv.classList.add("article");

            const articleText = document.createElement("p");
            articleText.textContent = article.text;
            articleDiv.appendChild(articleText);

            if (article.image) {
                const articleImage = document.createElement("img");
                articleImage.src = article.image;
                articleDiv.appendChild(articleImage);
            }

            // –õ–∞–π–∫
            const likeBtn = document.createElement("button");
            const likedKey = `liked_${index}_${localStorage.getItem("userEmail") || "guest"}`;
            const liked = localStorage.getItem(likedKey) === "true";
            likeBtn.textContent = `${liked ? "‚ù§Ô∏è" : "ü§ç"} ${likes[index]}`;
            likeBtn.style.marginTop = "5px";
            likeBtn.onclick = () => {
                if (liked) {
                    likes[index]--;
                    localStorage.setItem(likedKey, "false");
                } else {
                    likes[index]++;
                    localStorage.setItem(likedKey, "true");
                }
                saveToStorage();
                displayArticles();
            };
            articleDiv.appendChild(likeBtn);

            // –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
            const commentSection = document.createElement("div");
            commentSection.classList.add("comment");

            if (comments[index]) {
                comments[index].forEach(commentText => {
                    const commentP = document.createElement("p");
                    commentP.textContent = commentText;
                    commentSection.appendChild(commentP);
                });
            }

            articleDiv.appendChild(commentSection);

            // –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
            const newCommentInput = document.createElement("textarea");
            newCommentInput.rows = 2;
            newCommentInput.placeholder = "–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π...";
            newCommentInput.style.width = "100%";
            articleDiv.appendChild(newCommentInput);

            // –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
            const addCommentBtn = document.createElement("button");
            addCommentBtn.textContent = "–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π";
            addCommentBtn.style.marginTop = "5px";
            addCommentBtn.onclick = () => {
                const comment = newCommentInput.value.trim();
                if (!comment) {
                    alert("–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º");
                    return;
                }
                comments[index].push(comment);
                saveToStorage();
                displayArticles();
            };
            articleDiv.appendChild(addCommentBtn);

            // –ö–Ω–æ–ø–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å
            const modifyBtn = document.createElement("button");
            modifyBtn.textContent = "–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –º–æ–≥—É –∏–∑–º–µ–Ω–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å";
            modifyBtn.style.marginTop = "5px";
            modifyBtn.onclick = () => {
                const action = prompt("–í–≤–µ–¥–∏—Ç–µ '—É–¥–∞–ª–∏—Ç—å' —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é, –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–æ–≤—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:");
                if (!action) return;
                if (action.toLowerCase() === "—É–¥–∞–ª–∏—Ç—å") {
                    articles.splice(index, 1);
                    comments.splice(index, 1);
                    likes.splice(index, 1);
                } else {
                    articles[index].text = action;
                }
                saveToStorage();
                displayArticles();
            };
            articleDiv.appendChild(modifyBtn);

            articleList.appendChild(articleDiv);
        });
    }

    // ----------------------- –°—Ç–∞—Ä—Ç -----------------------
    displayArticles();
</script>

